# Refresh tmux configuration
unbind r
bind r source-file ~/.tmux.conf

# Set prefix
unbind C-b
set -g prefix C-a
# bind C-Space send-prefix

set -g set-clipboard on

# Vim mode
setw -g mode-keys vi
bind-key -r -T prefix C-h resize-pane -L
bind-key -r -T prefix C-j resize-pane -D
bind-key -r -T prefix C-k resize-pane -U
bind-key -r -T prefix C-l resize-pane -R

# After <C-s>+[ you enter copy mode.
bind-key -T copy-mode-vi 'v' send -X begin-selection
bind-key -T copy-mode-vi 'y' send -X copy-selection
bind-key -T copy-mode-vi 'C-v' send -X rectangle-toggle

# set 24 bit color
# set -g default-terminal "tmux*"
set-option -g default-terminal "tmux-256color"
set-option -sa terminal-overrides ",xterm*:Tc"

# Set zsh as default shell
set-option -g default-shell /usr/bin/fish

#Allow mouse use
set -g mouse on

# Start windows and panes counting at 1, not 0
set -g base-index 1
set -g pane-base-index 1
set-window-option -g pane-base-index 1
set-option -g renumber-windows on

# Open panes in current directory sa it is easier to navigate home if you need
# rather than to navigate where you were
bind '"' split-window -v -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"

# For displaying images in the terminal
set-option -g allow-passthrough on

# Shift Alt vim heys to switch windows
bind -n M-h previous-window
bind -n M-l next-window

set -g @plugin 'tmux-plugins/tpm'

set -g @plugin 'tmux-plugins/tmux-sensible'
# C-hjkl to navigate panes
set -g @plugin 'christoomey/vim-tmux-navigator'

##### STATUS BAR LOOK AND FEEL #####
# Catppuccin Mocha theme
# %hidden thm_pink="#f4b8e4"
# %hidden thm_mauve="#ca9ee6"
# %hidden thm_yellow="#f9e2af"
# %hidden thm_sky="#99d1db"
# %hidden thm_sapphire="#85c1dc"
# %hidden thm_blue="#89b4fa"
# %hidden thm_lavender="#b4befe"
# %hidden thm_text="#cdd6f4"
# %hidden thm_overlay2="#9399b2"
# %hidden thm_overlay1="#7f849c"
# %hidden thm_overlay0="#6c7086"
# %hidden thm_surface2="#585b70"
# %hidden thm_surface1="#45475a"
# %hidden thm_surface0="#313244"
# %hidden thm_base="#1e1e2e"
# %hidden thm_crust="#11111b"
# # darker alternate colors from other Catppuccin themes
# %hidden thm_yellow_macch="#e5c890"
# %hidden thm_blue_macch="#8caaee"
# %hidden thm_yellow_latte="#df8e1d"
# %hidden thm_blue_latte="#1e66f5"
#
# set -g clock-mode-colour "${thm_blue}"
# set -g copy-mode-current-match-style "fg=${thm_base},bg=${thm_yellow}"
# set -g copy-mode-match-style "fg=${thm_base},bg=${thm_blue}"
# set -g message-command-style "fg=${thm_blue},bg=${thm_base}"
# set -g message-style "fg=${thm_base},bg=${thm_blue}"
# set -g mode-style "fg=${thm_text},bg=${thm_surface2}"
# set -g pane-active-border-style "fg=${thm_lavender},bg=${thm_crust}"
# set -g pane-border-style "fg=${thm_overlay0},bg=${thm_crust}"
# set -g window-active-style "bg=#000000"
# set -g window-status-activity-style "fg=${thm_base},bg=${thm_blue}"
# set -g window-status-bell-style "fg=${thm_base},bg=${thm_yellow}"
# set -g window-status-current-style "fg=${thm_text},bg=${thm_surface2}"
# set -g window-status-separator " "
# set -g window-status-style "fg=${thm_text},bg=${thm_base}"
# set -g window-style "bg=${thm_crust}"

# set -g @plugin 'catppuccin/tmux'
# set -g @catppuccin_flavor 'mocha'
set -g status on
set -g status-position top   

# set -g @left ""
# set -g @right ""
# set -g @mode "copy-mode"
# set -g @prefix "#[bold]PREFIX#[none]"
# set -g @visual "#[bold]VISUAL#[none]"
# set -g @normal "#[bold]NORMAL#[none]"
#
# set -g status-left "#{?client_prefix,#[bg=#{@thm_peach}]#[fg=#{@thm_crust}] #{@prefix} #[bg=default]#[fg=#{@thm_peach}]#{@right},#{?#{==:#{pane_mode},#{@mode}},#[fg=#{@thm_mauve}]#{@left}#[bg=#{@thm_mauve}]#[fg=#{@thm_crust}] #{@visual} #[bg=default]#[fg=#{@thm_mauve}]#{@right},#[bg=#{@thm_blue}]#[fg=#{@thm_crust}] #{@normal} #[bg=default]#[fg=#{@thm_blue}]#{@right}}}"
# set -ag status-left "#[fg=default] #{b:pane_current_path}"
#
# set -g @catppuccin_window_text_color "#{@thm_surface_0}"
# set -g @catppuccin_window_text " #W #[bg=default]#[fg=#{@thm_surface_0}]#{@right}"
# set -g @catppuccin_window_number "#[bg=default]#[fg=#{@thm_surface_0}]#{@left}"
# set -g @catppuccin_window_current_text_color "#{@thm_lavender}"
# set -g @catppuccin_window_current_text "#[fg=#{@thm_crust}] #[bold]#W#[none] #[bg=default]#[fg=#{@thm_lavender}]#{@right}"
# set -g @catppuccin_window_current_number "#[bg=default]#[fg=#{@thm_lavender}]#{@left}"
#
# set -g status-right "#(uptime -p | sed -E 's/up //; s/,//g; s/ hours?/h/g; s/ minutes?/m/g') "
# set -ag status-right "#{?client_prefix,#[fg=#{@thm_peach}]#{@left}#[bg=#{@thm_peach}]#[fg=#{@thm_crust}] #[bold]#S#[none] #[bg=default]#[fg=#{@thm_peach}]#{@right},#{?#{==:#{pane_mode},#{@mode}},#[fg=#{@thm_mauve}]#{@left}#[bg=#{@thm_mauve}]#[fg=#{@thm_crust}] #[bold]#S#[none] #[bg=default]#[fg=#{@thm_mauve}]#{@right},#[fg=#{@thm_blue}]#{@left}#[bg=#{@thm_blue}]#[fg=#{@thm_crust}] #[bold]#S#[none] #[bg=default]#[fg=#{@thm_blue}]#{@right}}}"

# set -g status-justify left
# set -g status-left-length 100
# set -g status-right-length 100
# set -g status-style "fg=${thm_text},bg=${thm_crust}"
#
# set -g status-left "#[push-default]"
# set -ga status-left "#{?client_prefix,#[reverse],}"
# set -ga status-left "#[fg=${thm_mauve}] %H:%M "
# set -ga status-left "#{?client_prefix,#[noreverse],}"
# set -ga status-left "#[fg=${thm_pink}] #h "
# set -ga status-left "#[default] "
#
# set -g window-status-format "#[push-default]"
# set -ga window-status-format "#[bg=${thm_surface0}]"
# set -ga window-status-format "#{?window_active,#[bg=${thm_lavender}],}"
# set -ga window-status-format "#{?window_activity_flag,#[bg=${thm_blue_macch}],}"
# set -ga window-status-format "#{?window_bell_flag,#[bg=${thm_yellow_macch}],}"
# set -ga window-status-format "#{?window_marked_flag,#[bg=${thm_mauve}],}"
# set -ga window-status-format "#[fg=${thm_crust}]"
# set -ga window-status-format "#[fg=${thm_text}]"
# set -ga window-status-format "#{?window_active,#[fg=${thm_base}],}"
# set -ga window-status-format "#{?window_activity_flag,#[fg=${thm_base}],}"
# set -ga window-status-format "#{?window_bell_flag,#[fg=${thm_base}],}"
# set -ga window-status-format "#{?window_marked_flag,#[fg=${thm_base}],}"
# set -ga window-status-format " #I #[default] #W"
# set -ga window-status-format "#[fg=${thm_overlay1}]"
# set -ga window-status-format "#{?window_active,#[fg=${thm_overlay2}],}"
# set -ga window-status-format "#{?window_activity_flag,#[fg=${thm_blue_latte}],}"
# set -ga window-status-format "#{?window_bell_flag,#[fg=${thm_yellow_latte}],}"
# set -ga window-status-format "#{=1:#{p1:#{s/\\*//:window_flags}}}"
# set -ga window-status-format "#[default,fg=${thm_crust},reverse]#[default]"
# set -g window-status-current-format "#{E:window-status-format}"
#
# set -g status-right " #[push-default]"
# set -ga status-right "#[fg=${thm_crust},bg=${thm_blue}] "
# set -ga status-right "#[fg=${thm_blue},bg=${thm_pink}] "
# set -ga status-right "#[fg=${thm_pink},bg=${thm_text}] "
# set -ga status-right "#[fg=${thm_text},bg=${thm_pink}] "
# set -ga status-right "#[fg=${thm_pink},bg=${thm_blue}] "
# set -ga status-right "#[fg=${thm_blue},bg=${thm_crust}] "
# set -ga status-right "#[fg=${thm_crust},bg=${thm_yellow}] "
# set -ga status-right "#[fg=${thm_yellow},bg=${thm_text}] "
# set -ga status-right "#[fg=${thm_text},bg=${thm_mauve}] "
# set -ga status-right "#[fg=${thm_mauve},bg=${thm_surface1}] "
# set -ga status-right "#[fg=${thm_surface1},bg=${thm_crust}] "
# set -ga status-right "#[fg=${thm_sky}] #{pane_width}x#{pane_height} "
# set -ga status-right "#[fg=${thm_sapphire}] [#S] "
# set -ga status-right "#[default]"
# --- Lualine-like statusline (Catppuccin Mocha) ---
# Palette (matches nvim-lualine Catppuccin Mocha)
set -g @thm_blue       "#89b4fa"
set -g @thm_green      "#a6e3a1"
set -g @thm_peach      "#fab387"
set -g @thm_mauve      "#cba6f7"
set -g @thm_red        "#f38ba8"
set -g @thm_text       "#cdd6f4"
set -g @thm_overlay0   "#6c7086"
set -g @thm_surface0   "#313244"
set -g @thm_surface1   "#45475a"
set -g @thm_mantle     "#181825"
set -g @thm_crust      "#11111b"

# Overall bar styling
set -g status on
set -g status-position top
set -g status-interval 1
set -g status-justify centre
set -g status-style "fg=#{@thm_text},bg=#{@thm_crust}"
set -g status-left-length 120
set -g status-right-length 120

# Mode-aware colors to mirror lualine sections
# - Prefix  : peach (command-like)
# - Copy    : mauve (visual-like)
# - Normal  : blue
# All accent colours propagate to the mode badge, window tabs, and right-side badges.
set -g status-left "#{?client_prefix,#[bg=#fab387]#[fg=#11111b] 󰘳 PREFIX #[bg=#313244]#[fg=#fab387],#{?#{==:#{pane_mode},copy-mode},#[bg=#cba6f7]#[fg=#11111b]  COPY #[bg=#313244]#[fg=#cba6f7],#[bg=#89b4fa]#[fg=#11111b]  NORMAL #[bg=#313244]#[fg=#89b4fa]}}#[bg=#313244]#[fg=#cdd6f4] #S #[fg=#6c7086] #[fg=#cdd6f4]#{b:pane_current_path} #[bg=#11111b]#[fg=#313244]"

# Right side: pane size, host, time with dynamic accent
set -g status-right "#[fg=#6c7086] #[fg=#cdd6f4]#{pane_width}x#{pane_height} #[fg=#313244]#{?client_prefix,#[fg=#fab387]#[bg=#313244],#{?#{==:#{pane_mode},copy-mode},#[fg=#cba6f7]#[bg=#313244],#[fg=#89b4fa]#[bg=#313244]}} #(whoami)@#H #{?client_prefix,#[fg=#fab387]#[bg=#313244],#{?#{==:#{pane_mode},copy-mode},#[fg=#cba6f7]#[bg=#313244],#[fg=#89b4fa]#[bg=#313244]}}#{?client_prefix,#[fg=#11111b]#[bg=#fab387],#{?#{==:#{pane_mode},copy-mode},#[fg=#11111b]#[bg=#cba6f7],#[fg=#11111b]#[bg=#89b4fa]}}  %H:%M #[default]"
# Window tabs with powerline separators; active tab follows accent colour
set -g window-status-separator ""
set -g window-status-format "#[fg=#313244,bg=#11111b]#[bg=#313244,fg=#cdd6f4] #I:#W #[fg=#313244,bg=#11111b]"
set -g window-status-current-format "#[fg=#45475a,bg=#11111b]#[bg=#45475a,fg=#cdd6f4] #I:#W #[fg=#45475a,bg=#11111b]"

# Theme configuration
# set -g @plugin 'catppuccin/tmux'
# set -g @catppuccin_flavor 'mocha'
# set -g @catppuccin_window_status_style "rounded"
#
# set -g @catppuccin_window_left_separator "█"
# set -g @catppuccin_window_right_separator "█ "
# set -g @catppuccin_window_number_position "right"
# set -g @catppuccin_window_middle_separator "  █"
#
# set -g @catppuccin_window_default_text "#W"
# set -g @catppuccin_window_default_fill "number"
# set -g @catppuccin_window_current_fill "number"
# set -g @catppuccin_window_current_text "#W"
# set -g @catppuccin_window_current_background "#1e1e2e"
# set -g @catppuccin_window_current_color "#a6e3a1"
#
# set -g @catppuccin_status_modules_right "directory user host session"
# set -g @catppuccin_status_left_separator  " "
# set -g @catppuccin_status_right_separator ""
# set -g @catppuccin_status_fill "icon"
# set -g @catppuccin_status_connect_separator "no"
#
# set -g @catppuccin_directory_text "#{pane_current_path}" 
# set -g @catppuccin_date_time_text "%Y-%m-%d %H:%M:%S"

# Which-key plugin
set -g @plugin 'alexwforsythe/tmux-which-key'

# Tmuxifier
# Trigger TPM's install command with prefix + I to install Tmuxifier to TPM's plugin directory (default is $HOME/.tmux/plugins).
# To use the tmuxifier command, you will need to add the bin directory to your PATH. If you are using the default TPM plugin directory, the bin directory will be $HOME/.tmux/plugins/tmuxifier/bin.
set -g @plugin 'jimeh/tmuxifier'

# To fix that copy-mode-vi does not work on macos
set -g @plugin 'tmux-plugins/tmux-yank'

run '~/.tmux/plugins/tpm/tpm'
