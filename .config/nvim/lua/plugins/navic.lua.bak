return {
  {
    "SmiteshP/nvim-navic",
    lazy = true,
    event = "LspAttach",
    config = function()
      vim.g.navic_silence = true

      vim.api.nvim_create_autocmd("LspAttach", {
        callback = function(args)
          local client = vim.lsp.get_client_by_id(args.data.client_id)
          local buffer = args.buf

          if client and client.server_capabilities.documentSymbolProvider then
            require("nvim-navic").attach(client, buffer)
            -- Set up winbar with navic
            vim.schedule(function()
              if vim.api.nvim_buf_is_valid(buffer) then
                vim.api.nvim_buf_set_option(buffer, "winbar", "%{%v:lua.require'nvim-navic'.get_location()%}")
              end
            end)
          end
        end,
      })
    end,
    opts = {
      separator = " > ",
      highlight = true,
      depth_limit = 0,
      lazy_update_context = false,
    },
    init = function()
      vim.api.nvim_set_hl(0, "NavicIconsFile", { link = "Directory" })
      vim.api.nvim_set_hl(0, "NavicIconsModule", { link = "@namespace" })
      vim.api.nvim_set_hl(0, "NavicIconsNamespace", { link = "@namespace" })
      vim.api.nvim_set_hl(0, "NavicIconsPackage", { link = "@namespace" })
      vim.api.nvim_set_hl(0, "NavicIconsClass", { link = "Type" })
      vim.api.nvim_set_hl(0, "NavicIconsMethod", { link = "Function" })
      vim.api.nvim_set_hl(0, "NavicIconsProperty", { link = "@property" })
      vim.api.nvim_set_hl(0, "NavicIconsField", { link = "@field" })
      vim.api.nvim_set_hl(0, "NavicIconsConstructor", { link = "Special" })
      vim.api.nvim_set_hl(0, "NavicIconsEnum", { link = "Type" })
      vim.api.nvim_set_hl(0, "NavicIconsInterface", { link = "Type" })
      vim.api.nvim_set_hl(0, "NavicIconsFunction", { link = "Function" })
      vim.api.nvim_set_hl(0, "NavicIconsVariable", { link = "@variable" })
      vim.api.nvim_set_hl(0, "NavicIconsConstant", { link = "Constant" })
      vim.api.nvim_set_hl(0, "NavicIconsString", { link = "String" })
      vim.api.nvim_set_hl(0, "NavicIconsNumber", { link = "Number" })
      vim.api.nvim_set_hl(0, "NavicIconsBoolean", { link = "Boolean" })
      vim.api.nvim_set_hl(0, "NavicIconsArray", { link = "Type" })
      vim.api.nvim_set_hl(0, "NavicIconsObject", { link = "Type" })
      vim.api.nvim_set_hl(0, "NavicIconsKey", { link = "Identifier" })
      vim.api.nvim_set_hl(0, "NavicIconsNull", { link = "Comment" })
      vim.api.nvim_set_hl(0, "NavicIconsEnumMember", { link = "Constant" })
      vim.api.nvim_set_hl(0, "NavicIconsStruct", { link = "Type" })
      vim.api.nvim_set_hl(0, "NavicIconsEvent", { link = "Function" })
      vim.api.nvim_set_hl(0, "NavicIconsOperator", { link = "Operator" })
      vim.api.nvim_set_hl(0, "NavicIconsTypeParameter", { link = "Type" })
      vim.api.nvim_set_hl(0, "NavicText", { link = "Comment" })
      vim.api.nvim_set_hl(0, "NavicSeparator", { link = "Comment" })
    end,
  },
}
